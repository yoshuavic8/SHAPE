(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[675],{45629:(e,t,s)=>{Promise.resolve().then(s.bind(s,65496))},65496:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var i=s(95155),a=s(12115),n=s(35695),r=s(88482),l=s(97168),u=s(49026),o=s(5838),d=s(7550),c=s(96756),h=s(25550),p=s(44917),g=s(98855),v=s(46414),x=s(14503);function j(){let[e,t]=(0,a.useState)({}),[s,j]=(0,a.useState)(0),[f,y]=(0,a.useState)(!1),[w,S]=(0,a.useState)(null),_=(0,n.useRouter)(),{toast:m}=(0,x.dj)(),N=o.My.find(e=>"heart"===e.id),q=(null==N?void 0:N.questions)||[];(0,a.useEffect)(()=>((async()=>{let{data:{session:e}}=await v.N.auth.getSession();if(!e){_.push("/auth/login");return}let{data:s}=await v.N.from("questionnaire_results").select("heart_desire").eq("user_id",e.user.id).single();if(null==s?void 0:s.heart_desire){let e={};Object.entries(s.heart_desire).forEach(t=>{let[s,i]=t;e[s]=i}),t(e)}})(),S(setInterval(k,1e4)),()=>{w&&clearInterval(w)}),[_]);let k=async()=>{if(0!==Object.keys(e).length)try{let{data:{session:t}}=await v.N.auth.getSession();if(!t)return;await v.N.from("questionnaire_results").update({heart_desire:e}).eq("user_id",t.user.id),console.log("Auto-saved answers at",new Date().toLocaleTimeString())}catch(e){console.error("Auto-save failed:",e)}},b=q[s],C=s===q.length-1,E=e=>{t(t=>({...t,[b.id]:e}))},I=async()=>{try{y(!0);let{data:{session:t}}=await v.N.auth.getSession();if(!t){_.push("/auth/login");return}let{error:s}=await v.N.from("questionnaire_results").update({heart_desire:e}).eq("user_id",t.user.id);if(s)throw s;m({title:"Progress saved",description:"Your answers have been saved successfully"}),_.push("/questionnaire/personality")}catch(e){m({title:"Error",description:e.message||"Failed to save your answers",variant:"destructive"})}finally{y(!1)}},P=b&&void 0!==e[b.id];return(0,i.jsxs)("div",{className:"space-y-6 py-8",children:[(0,i.jsx)(d.v,{currentSection:2,totalSections:4,currentQuestion:s+1,totalQuestions:q.length}),(0,i.jsxs)(r.Zp,{children:[(0,i.jsxs)(r.aR,{children:[(0,i.jsx)(r.ZB,{children:"Heart Desire (Keinginan Hati)"}),(0,i.jsx)(r.BT,{children:'Jawablah setiap pernyataan sesuai dengan jenis pertanyaan. Untuk pertanyaan skala, 1 adalah "Sangat Tidak Setuju" dan 5 adalah "Sangat Setuju". Untuk pertanyaan pilihan ganda, pilih opsi yang paling sesuai.'})]}),(0,i.jsxs)(r.Wu,{className:"space-y-4",children:[b&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{className:"text-lg font-medium mb-4",children:[s+1,". ",b.text]}),"scale"===b.type&&(0,i.jsx)(c.z,{questionId:b.id,value:e[b.id]||0,onChange:E}),"open"===b.type&&(0,i.jsx)(h.n,{questionId:b.id,value:e[b.id]||"",onChange:E}),"multiple"===b.type&&b.options&&!b.text.includes("Urutkan")&&(0,i.jsx)(p.Y,{questionId:b.id,options:b.options,value:e[b.id]||"",onChange:E,multiSelect:b.text.includes("Pilih")}),"multiple"===b.type&&b.options&&b.text.includes("Urutkan")&&(0,i.jsx)(g.U,{questionId:b.id,options:b.options,value:e[b.id]||[],onChange:E})]}),!P&&(0,i.jsxs)(u.Fc,{variant:"destructive",children:[(0,i.jsx)(u.XL,{children:"Required"}),(0,i.jsx)(u.TN,{children:"Please answer the question before proceeding."})]})]}),(0,i.jsxs)(r.wL,{className:"flex justify-between",children:[(0,i.jsx)(l.$,{variant:"outline",onClick:()=>{s>0?j(s-1):_.push("/questionnaire/spiritual")},children:"Previous"}),C?(0,i.jsx)(l.$,{onClick:I,disabled:!P||f,children:f?"Saving...":"Continue to Next Section"}):(0,i.jsx)(l.$,{onClick:()=>{s<q.length-1&&j(s+1)},disabled:!P,children:"Next Question"})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[309,352,769,559,221,690,257,395,441,684,358],()=>t(45629)),_N_E=e.O()}]);