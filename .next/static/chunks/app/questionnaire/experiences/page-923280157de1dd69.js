(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{44090:(e,t,s)=>{Promise.resolve().then(s.bind(s,55333))},55333:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var i=s(95155),n=s(12115),a=s(35695),l=s(88482),r=s(97168),u=s(49026),o=s(5838),d=s(7550),c=s(96756),h=s(25550),p=s(44917),x=s(98855),v=s(46414),j=s(14503);function f(){let[e,t]=(0,n.useState)({}),[s,f]=(0,n.useState)(0),[g,m]=(0,n.useState)(!1),[y,w]=(0,n.useState)(null),S=(0,a.useRouter)(),{toast:N}=(0,j.dj)(),q=o.My.find(e=>"experiences"===e.id),k=(null==q?void 0:q.questions)||[];(0,n.useEffect)(()=>((async()=>{let{data:{session:e}}=await v.N.auth.getSession();if(!e){S.push("/auth/login");return}let{data:s}=await v.N.from("questionnaire_results").select("experiences").eq("user_id",e.user.id).single();if(null==s?void 0:s.experiences){let e={};Object.entries(s.experiences).forEach(t=>{let[s,i]=t;e[s]=i}),t(e)}})(),w(setInterval(_,1e4)),()=>{y&&clearInterval(y)}),[S]);let _=async()=>{if(0!==Object.keys(e).length)try{let{data:{session:t}}=await v.N.auth.getSession();if(!t)return;await v.N.from("questionnaire_results").update({experiences:e}).eq("user_id",t.user.id),console.log("Auto-saved answers at",new Date().toLocaleTimeString())}catch(e){console.error("Auto-save failed:",e)}},b=k[s],C=s===k.length-1,E=e=>{t(t=>({...t,[b.id]:e}))},I=async()=>{try{m(!0);let{data:{session:t}}=await v.N.auth.getSession();if(!t){S.push("/auth/login");return}let{error:s}=await v.N.from("questionnaire_results").update({experiences:e,is_completed:!0}).eq("user_id",t.user.id);if(s)throw s;N({title:"Questionnaire completed!",description:"Your answers have been saved successfully. View your results now."}),S.push("/results")}catch(e){N({title:"Error",description:e.message||"Failed to save your answers",variant:"destructive"})}finally{m(!1)}},P=b&&void 0!==e[b.id];return(0,i.jsxs)("div",{className:"space-y-6 py-8",children:[(0,i.jsx)(d.v,{currentSection:4,totalSections:4,currentQuestion:s+1,totalQuestions:k.length}),(0,i.jsxs)(l.Zp,{children:[(0,i.jsxs)(l.aR,{children:[(0,i.jsx)(l.ZB,{children:"Experiences (Pengalaman)"}),(0,i.jsx)(l.BT,{children:'Jawablah setiap pernyataan dengan skala 1-5, di mana 1 adalah "Sangat Tidak Setuju" dan 5 adalah "Sangat Setuju".'})]}),(0,i.jsxs)(l.Wu,{className:"space-y-4",children:[b&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{className:"text-lg font-medium mb-4",children:[s+1,". ",b.text]}),"scale"===b.type&&(0,i.jsx)(c.z,{questionId:b.id,value:e[b.id]||0,onChange:E}),"open"===b.type&&(0,i.jsx)(h.n,{questionId:b.id,value:e[b.id]||"",onChange:E}),"multiple"===b.type&&b.options&&(0,i.jsx)(p.Y,{questionId:b.id,options:b.options,value:e[b.id]||(b.text.includes("Urutkan")?[]:""),onChange:E,multiSelect:b.text.includes("Pilih")&&!b.text.includes("Urutkan")}),"multiple"===b.type&&b.options&&b.text.includes("Urutkan")&&(0,i.jsx)(x.U,{questionId:b.id,options:b.options,value:e[b.id]||[],onChange:E})]}),!P&&(0,i.jsxs)(u.Fc,{variant:"destructive",children:[(0,i.jsx)(u.XL,{children:"Required"}),(0,i.jsx)(u.TN,{children:"Please answer the question before proceeding."})]})]}),(0,i.jsxs)(l.wL,{className:"flex justify-between",children:[(0,i.jsx)(r.$,{variant:"outline",onClick:()=>{s>0?f(s-1):S.push("/questionnaire/personality")},children:"Previous"}),C?(0,i.jsx)(r.$,{onClick:I,disabled:!P||g,children:g?"Saving...":"Complete & View Results"}):(0,i.jsx)(r.$,{onClick:()=>{s<k.length-1&&f(s+1)},disabled:!P,children:"Next Question"})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[309,352,769,559,221,690,257,395,441,684,358],()=>t(44090)),_N_E=e.O()}]);